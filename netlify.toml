[build]
  command = "pnpm run build"
  publish = ".next"

[build.environment]
  NODE_VERSION = "18"
  PNPM_VERSION = "8.10.0"
  AWS_LAMBDA_JS_RUNTIME = "nodejs18.x"

[[plugins]]
  package = "@netlify/plugin-lighthouse"

[[plugins]]
  package = "@netlify/plugin-nextjs"

[[headers]]
  for = "/*"
  [headers.values]
    Content-Security-Policy = "default-src 'none'; base-uri 'none'; child-src 'self' app.netlify.com; form-action 'none'; frame-ancestors 'none'; img-src 'self' images.prismic.io assets.coingecko.com s2.coinmarketcap.com *.cloudfront.net https://blogger.googleusercontent.com data:; media-src 'self'; object-src 'none'; script-src 'self' ajax.googleapis.com widgets.coingecko.com files.coinmarketcap.com 3rdparty-apis.coinmarketcap.com app.netlify.com netlify-cdp-loader.netlify.app *.googletagmanager.com https://connect.facebook.net; script-src-elem 'self' ajax.googleapis.com widgets.coingecko.com files.coinmarketcap.com 3rdparty-apis.coinmarketcap.com *.googletagmanager.com 'sha256-nECR5ZMSmALAY0Is6h2I1XmPYs9GXOZrQo37nfyAA0Y='; style-src 'self' fonts.googleapis.com 'unsafe-inline' files.coinmarketcap.com 'unsafe-inline'; font-src 'self' fonts.gstatic.com; connect-src 'self' api.coingecko.com 3rdparty-apis.coinmarketcap.com wss://cable.coingecko.com ocean.defichain.com api.github.com *.google-analytics.com region1.google-analytics.com;"

[[headers]]
  for = "/keys/security@defichain.com.public.key"
  [headers.values]
    Content-Type = "text/plain"

[[redirects]]
  from = "http://defichain.com/*"
  to = "https://defichain.com/:splat"
  status = 301
  force = true

[[redirects]]
  from = "http://zhs.defichain.com/*"
  to = "https://defichain.com/zh-Hans/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://zhs.defichain.com/*"
  to = "https://defichain.com/zh-Hans/:splat"
  status = 301
  force = true

[[redirects]]
  from = "http://zht.defichain.com/*"
  to = "https://defichain.com/zh-Hant/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://zht.defichain.com/*"
  to = "https://defichain.com/zh-Hant/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://defichain.com/dfi-token"
  to = "https://defichain.com/dfi"
  status = 301
  force = true
